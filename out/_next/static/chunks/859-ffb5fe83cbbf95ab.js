"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[859],{658:(e,t,n)=>{n.d(t,{Yn:()=>i,ZH:()=>r,yy:()=>a});let i=e=>e<10?"0".concat(e):e,r=e=>e.charAt(0).toUpperCase()+e.slice(1),a=e=>new Promise(t=>setTimeout(t,e))},3816:(e,t,n)=>{n.d(t,{V:()=>r,e:()=>a});var i=n(658);let r=async(e,t)=>{var n,r;let a=new Date,l=a.getUTCFullYear(),c=a.getUTCMonth()+1,s=(0,i.Yn)(c),d=await fetch("https://api.chess.com/pub/player/".concat(e,"/games/").concat(l,"/").concat(s),{method:"GET",signal:t}),u=await d.json();if(d.status>=400&&"Date cannot be set in the future"!==u.message)throw Error("Error fetching games from Chess.com");let h=null!==(n=null==u?void 0:u.games)&&void 0!==n?n:[];if(h.length<50){let t=1===c?12:c-1,n=(0,i.Yn)(t),a=await fetch("https://api.chess.com/pub/player/".concat(e,"/games/").concat(12===t?l-1:l,"/").concat(n)),o=await a.json();h.push(...null!==(r=null==o?void 0:o.games)&&void 0!==r?r:[])}return h.filter(e=>e.pgn&&e.end_time).sort((e,t)=>t.end_time-e.end_time).slice(0,50).map(o)},a=async e=>{let t=encodeURIComponent(e.trim().toLowerCase()),n=await fetch("https://api.chess.com/pub/player/".concat(t)),i=await n.json(),r=null==i?void 0:i.avatar;return"string"==typeof r?r:null},o=e=>{var t,n,i,r,a,o,c,s,d;let u=null===(t=e.pgn.match(/\[Result "(.*?)"]/))||void 0===t?void 0:t[1],h=null===(n=e.pgn.match(/\d+?\. /g))||void 0===n?void 0:n.length;return{id:e.uuid||(null===(i=e.url)||void 0===i?void 0:i.split("/").pop())||e.id,pgn:e.pgn||"",white:{name:(null===(r=e.white)||void 0===r?void 0:r.username)||"White",rating:(null===(a=e.white)||void 0===a?void 0:a.rating)||0,title:null===(o=e.white)||void 0===o?void 0:o.title},black:{name:(null===(c=e.black)||void 0===c?void 0:c.username)||"Black",rating:(null===(s=e.black)||void 0===s?void 0:s.rating)||0,title:null===(d=e.black)||void 0===d?void 0:d.title},result:u,timeControl:l(e),date:e.end_time?new Date(1e3*e.end_time).toLocaleDateString():new Date().toLocaleDateString(),movesNb:h?2*h:void 0,url:e.url}},l=e=>{let t=e.time_control;if(!t)return;let[n,r]=t.split("+");if(!n)return;let a=Number(n),o=r?"+".concat(r):"";if(a<60)return"".concat(a,"s").concat(o);if(a<3600){let e=Math.floor(a/60),t=a%60;return t?"".concat(e,"m").concat((0,i.Yn)(t),"s").concat(o):"".concat(e,"m").concat(o)}let l=Math.floor(a/3600),c=Math.floor(a%3600/60);return c?"".concat(l,"h").concat((0,i.Yn)(c),"m").concat(o):"".concat(l,"h").concat(o)}},9320:(e,t,n)=>{n.d(t,{$:()=>c});var i=n(16042),r=n(69114),a=n(65364);let o=a.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID?{apiKey:a.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:a.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:a.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:a.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:a.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:a.env.NEXT_PUBLIC_FIREBASE_APP_ID,measurementId:a.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID}:void 0,l=o?(0,i.Wp)(o):void 0;(0,r.TT)().then(e=>{e&&l&&(0,r.P5)(l)});let c=async(e,t)=>{if("localhost"===window.location.hostname||!await (0,r.TT)()||!l)return;let n=(0,r.P5)(l);(0,r.$s)(n,e,t)}},18259:(e,t,n)=>{n.d(t,{A:()=>v});var i=n(37876),r=n(98594),a=n(31084),o=n(9227),l=n(77018),c=n(58862),s=n(70946),d=n(15027),u=n(54773),h=n(18978),m=n(14232);function v(e){let{min:t,max:n,label:u,value:h,setValue:v,size:f,marksFilter:p,step:w=1,infoContent:b}=e,[x,k]=(0,m.useState)(null),C=e=>{k(e.currentTarget)},E=()=>{k(null)};return(0,i.jsxs)(a.A,{container:!0,justifyContent:"center",alignItems:"center",size:null!=f?f:11,children:[(0,i.jsxs)(o.A,{direction:"row",width:"100%",children:[(0,i.jsx)(l.A,{id:"input-".concat(u),variant:"body2",children:1===w&&p?u:"".concat(u,": ").concat(h)}),!!b&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.x,{onClickAway:E,children:(0,i.jsx)(s.A,{size:"medium","aria-owns":x?"mouse-over-popover":void 0,"aria-haspopup":"true",onClick:C,onMouseEnter:C,onMouseLeave:E,sx:{ml:1,padding:0},"aria-label":"Help about number of threads",children:(0,i.jsx)(r.In,{icon:"mdi:info-outline",width:"1.1rem"})})}),(0,i.jsx)(d.Ay,{id:"mouse-over-popover",open:!!x,anchorEl:x,onClose:E,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},sx:{pointerEvents:"none"},disableRestoreFocus:!0,children:(0,i.jsx)(l.A,{variant:"body2",sx:{padding:2,maxWidth:500},children:b})})]})]}),(0,i.jsx)(g,{min:t,max:n,marks:p?Array.from({length:n-t+1},(e,n)=>({value:n+t,label:"".concat(n+t)})).filter((e,t)=>t%p==0):void 0,step:w,valueLabelDisplay:"off",value:h,onChange:(e,t)=>v(t),"aria-labelledby":"input-".concat(u)})]})}let g=(0,u.Ay)(h.Ay)(()=>({".MuiSlider-markLabel":{fontSize:"0.8rem",lineHeight:"0.8rem"},".MuiSlider-thumb":{width:"18px",height:"18px"},marginBottom:"1rem"}))},19410:(e,t,n)=>{n.d(t,{h:()=>B});var i=n(37876),r=n(11494),a=n(31084),o=n(57065),l=n(99542),c=n(85278),s=n(65897),d=n(14232),u=n(19271),h=n(54587),m=n.n(h),v=n(92094),g=n(99509);let f={position:"absolute",width:"100%",height:"100%",backgroundColor:"#eb6150",opacity:"0.8"},p={position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,.14)",padding:"35%",backgroundClip:"content-box",borderRadius:"50%",boxSizing:"border-box"},w=e=>({position:"absolute",width:"100%",height:"100%",backgroundColor:e?v.k_[e]:"#fad541",opacity:.5});var b=n(77018),x=n(24307);function k(e){let{height:t,boardOrientation:n,currentPositionAtom:o=(0,l.eU)({})}=e,[s,h]=(0,d.useState)({whiteBarPercentage:50,label:"0.0"}),m=(0,c.md)(o);return(0,d.useEffect)(()=>{var e;let t=null==m?void 0:null===(e=m.eval)||void 0===e?void 0:e.lines[0];m.eval&&t&&!(t.depth<6)&&h((0,x.nY)(m.eval))},[m]),(0,i.jsxs)(a.A,{container:!0,justifyContent:"center",alignItems:"center",width:"2rem",height:t,border:"1px solid black",borderRadius:"5px",children:[(0,i.jsx)(r.A,{sx:{backgroundColor:n===u.Q1.White?"#424242":"white",transition:"height 1s"},height:"".concat(n===u.Q1.White?100-s.whiteBarPercentage:s.whiteBarPercentage,"%"),width:"100%",borderRadius:100===s.whiteBarPercentage?"5px":"5px 5px 0 0",children:(0,i.jsx)(b.A,{color:n===u.Q1.White?"white":"black",textAlign:"center",width:"100%",children:s.whiteBarPercentage<50&&n===u.Q1.White||s.whiteBarPercentage>=50&&n===u.Q1.Black?s.label:""})}),(0,i.jsx)(r.A,{sx:{backgroundColor:n===u.Q1.White?"white":"#424242",transition:"height 1s"},height:"".concat(n===u.Q1.White?s.whiteBarPercentage:100-s.whiteBarPercentage,"%"),width:"100%",display:"flex",alignItems:"flex-end",borderRadius:100===s.whiteBarPercentage?"5px":"0 0 5px 5px",children:(0,i.jsx)(b.A,{color:n===u.Q1.White?"black":"white",textAlign:"center",width:"100%",children:s.whiteBarPercentage>=50&&n===u.Q1.White||s.whiteBarPercentage<50&&n===u.Q1.Black?s.label:""})})]})}var C=n(9227),E=n(24422);function A(e){let{fen:t,color:n}=e,r=(0,d.useMemo)(()=>(0,x.Kz)(t,n).map(e=>{let{piece:t,count:n}=e;return S(t,n)}),[t,n]),o=(0,d.useMemo)(()=>{let e=(0,x.LR)(t);return n===u.Q1.White?e:-e},[t,n]);return(0,i.jsxs)(a.A,{container:!0,alignItems:"end",spacing:.7,size:"auto",marginLeft:"-".concat(.165,"rem"),children:[(0,i.jsx)(C.A,{direction:"row",spacing:.1,children:r}),o>0&&(0,i.jsxs)(b.A,{lineHeight:"".concat(.8250000000000001,"rem"),fontSize:"".concat(.8250000000000001,"rem"),marginLeft:.3,children:["+",o]})]})}let S=(e,t)=>t?(0,i.jsx)(C.A,{direction:"row",spacing:"-".concat(.66,"rem"),children:Array(t).fill(0).map((t,n)=>(0,i.jsx)(r.A,{width:"".concat(1.1,"rem"),height:"".concat(1.1,"rem"),sx:{backgroundImage:"url(/piece/cardinal/".concat(e,".svg)"),backgroundRepeat:"no-repeat"}},"".concat(e,"-").concat(n)))},e):null;var y=n(658);function j(e){let{color:t,player:n,gameAtom:r}=e,o=(0,c.md)(r),l=o.fen(),s=(0,d.useMemo)(()=>{if(o.turn()===t){var e,n;let t=null===(e=o.history({verbose:!0}).at(-1))||void 0===e?void 0:e.before;return I(null===(n=o.getComments().find(e=>{let{fen:n}=e;return n===t}))||void 0===n?void 0:n.comment)}return I(o.getComment())},[o,t]);return(0,i.jsxs)(a.A,{container:!0,justifyContent:"space-between",alignItems:"center",size:12,children:[(0,i.jsxs)(C.A,{direction:"row",children:[(0,i.jsx)(E.A,{src:n.avatarUrl,alt:n.name,variant:"circular",sx:{width:40,height:40,backgroundColor:t===u.Q1.White?"white":"black",color:t===u.Q1.White?"black":"white",border:"1px solid black"},children:n.name[0].toUpperCase()}),(0,i.jsxs)(C.A,{marginLeft:1,children:[(0,i.jsxs)(C.A,{direction:"row",children:[(0,i.jsx)(b.A,{fontSize:"0.9rem",children:n.name}),n.rating&&(0,i.jsxs)(b.A,{marginLeft:.5,fontSize:"0.9rem",fontWeight:"200",children:["(",n.rating,")"]})]}),(0,i.jsx)(A,{fen:l,color:t})]})]}),s&&(0,i.jsxs)(b.A,{align:"center",sx:{backgroundColor:t===u.Q1.White?"white":"black",color:t===u.Q1.White?"black":"white"},borderRadius:"5px",padding:.8,border:"1px solid #424242",width:"5rem",textAlign:"right",children:[s.hours?"".concat(s.hours,":"):"",(0,y.Yn)(s.minutes),":",(0,y.Yn)(s.seconds),s.hours||s.minutes||s.seconds>20?"":".".concat(s.tenths)]})]})}let I=e=>{if(!e)return;let t=e.match(/\[%clk (\d+):(\d+):(\d+)(?:\.(\d*))?\]/);if(t)return{hours:parseInt(t[1]),minutes:parseInt(t[2]),seconds:parseInt(t[3]),tenths:t[4]?parseInt(t[4]):0}};var _=n(62465);function B(e){var t;let{id:n,canPlay:h,gameAtom:b,boardSize:x,whitePlayer:C,blackPlayer:E,boardOrientation:A=u.Q1.White,currentPositionAtom:S=(0,l.eU)({}),showBestMoveArrow:y=!1,showPlayerMoveIconAtom:I,showEvaluationBar:B=!1}=e,R=(0,d.useRef)(null),M=(0,c.md)(b),{playMove:Q}=(0,s.j)(b),W=(0,d.useMemo)(()=>(0,l.eU)([]),[]),T=(0,c.Xr)(W),z=(0,d.useMemo)(()=>(0,l.eU)([]),[]),U=(0,c.Xr)(z),L=(0,c.md)(S),[N,D]=(0,d.useState)(!1),[H,K]=(0,d.useState)(null),[O,F]=(0,d.useState)(null),q=(0,c.md)(g._),G=(0,c.md)(g.U),X=M.fen();(0,d.useEffect)(()=>{T([])},[X,T]);let Y=(0,d.useCallback)(e=>{let{piece:t}=e;return!M.isGameOver()&&!!h&&(!0===h||h===t[0])},[h,M]),$=(0,d.useCallback)((e,t,n)=>{var i,r;return!!Y({piece:n})&&!!Q({from:e,to:t,promotion:null!==(r=null===(i=n[1])||void 0===i?void 0:i.toLowerCase())&&void 0!==r?r:"q"})},[Y,Q]),J=(0,d.useCallback)(e=>{K(null!=e?e:null),F(null),D(!1),e?U(M.moves({square:e,verbose:!0}).map(e=>e.to)):U([])},[K,F,U,M]),V=(0,d.useCallback)((e,t)=>{if(T([]),!H){if(t&&!Y({piece:t}))return;J(e);return}let n=M.moves({square:H,verbose:!0}).find(t=>t.to===e);if(!n){J(e);return}if(F(e),"p"===n.piece&&("w"===n.color&&"8"===e[1]||"b"===n.color&&"1"===e[1])){D(!0);return}J(Q({from:H,to:e})?void 0:e)},[M,Y,H,Q,J,T]),Z=(0,d.useCallback)(e=>{T(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[T]),ee=(0,d.useCallback)((e,t)=>{J(t)},[J]),et=(0,d.useCallback)(()=>{J()},[J]),en=(0,d.useCallback)((e,t,n)=>{var i,r;if(!e)return!1;let a=null!==(r=null===(i=e[1])||void 0===i?void 0:i.toLowerCase())&&void 0!==r?r:"q";if(H&&O){let e=Q({from:H,to:O,promotion:a});return J(),!!e}if(t&&n){let e=Q({from:t,to:n,promotion:a});return J(),!!e}return J(H),!1},[H,O,Q,J]),ei=(0,d.useMemo)(()=>{var e,t;let n=null==L?void 0:null===(e=L.lastEval)||void 0===e?void 0:e.bestMove,i=null==L?void 0:null===(t=L.eval)||void 0===t?void 0:t.moveClassification;return n&&y&&i!==u.eK.Best&&i!==u.eK.Opening&&i!==u.eK.Forced&&i!==u.eK.Perfect?[[n.slice(0,2),n.slice(2,4),(0,_.A)(v.k_[u.eK.Best]).spin(-G).toHexString()]]:[]},[L,y,G]),er=(0,d.useMemo)(()=>(function(e){let{currentPositionAtom:t,clickedSquaresAtom:n,playableSquaresAtom:r,showPlayerMoveIconAtom:a=(0,l.eU)(!1)}=e,o=(0,d.forwardRef)((e,o)=>{var l,s,u;let{children:h,square:v,style:b}=e,x=(0,c.md)(a),k=(0,c.md)(t),C=(0,c.md)(n),E=(0,c.md)(r),A=(0,c.md)(g.U),S=null===(l=k.lastMove)||void 0===l?void 0:l.from,y=null===(s=k.lastMove)||void 0===s?void 0:s.to,j=null==k?void 0:null===(u=k.eval)||void 0===u?void 0:u.moveClassification,I=(0,d.useMemo)(()=>C.includes(v)?f:S===v||y===v?w(j):void 0,[C,v,S,y,j]),_=(0,d.useMemo)(()=>E.includes(v)?p:void 0,[E,v]);return(0,i.jsxs)("div",{ref:o,style:{...b,position:"relative",filter:A?"hue-rotate(-".concat(A,"deg)"):void 0},children:[h,I&&(0,i.jsx)("div",{style:I}),_&&(0,i.jsx)("div",{style:_}),j&&x&&v===y&&(0,i.jsx)(m(),{src:"/icons/".concat(j,".png"),alt:"move-icon",width:35,height:35,style:{position:"absolute",top:"max(-12px, -1.8vw)",right:"max(-12px, -1.8vw)",maxWidth:"3.6vw",maxHeight:"3.6vw",zIndex:100}})]})});return o.displayName="SquareRenderer",o})({currentPositionAtom:S,clickedSquaresAtom:W,playableSquaresAtom:z,showPlayerMoveIconAtom:I}),[S,W,z,I]),ea=(0,d.useMemo)(()=>P.reduce((e,t)=>(e[t]=e=>{let{squareWidth:n}=e;return(0,i.jsx)(r.A,{width:n,height:n,sx:{backgroundImage:"url(/piece/".concat(q,"/").concat(t,".svg)"),backgroundSize:"contain"}})},e),{}),[q]),eo=(0,d.useMemo)(()=>{let e={borderRadius:"5px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.5)"};return G?{...e,filter:"hue-rotate(".concat(G,"deg)")}:e},[G]);return(0,i.jsxs)(a.A,{container:!0,justifyContent:"center",alignItems:"center",wrap:"nowrap",width:x,children:[B&&(0,i.jsx)(k,{height:(null==R?void 0:null===(t=R.current)||void 0===t?void 0:t.offsetHeight)||x||400,boardOrientation:A,currentPositionAtom:S}),(0,i.jsxs)(a.A,{container:!0,rowGap:1.5,justifyContent:"center",alignItems:"center",paddingLeft:2*!!B,size:"grow",children:[(0,i.jsx)(j,{color:A===u.Q1.White?u.Q1.Black:u.Q1.White,gameAtom:b,player:A===u.Q1.White?E:C}),(0,i.jsx)(a.A,{container:!0,justifyContent:"center",alignItems:"center",ref:R,size:12,children:(0,i.jsx)(o.Ve,{id:"".concat(n,"-").concat(h),position:X,onPieceDrop:$,boardOrientation:A===u.Q1.White?"white":"black",customBoardStyle:eo,customArrows:ei,isDraggablePiece:Y,customSquare:er,onSquareClick:V,onSquareRightClick:Z,onPieceDragBegin:ee,onPieceDragEnd:et,onPromotionPieceSelect:en,showPromotionDialog:N,promotionToSquare:O,animationDuration:200,customPieces:ea})}),(0,i.jsx)(j,{color:A,gameAtom:b,player:A===u.Q1.White?C:E})]})]})}let P=["wP","wB","wN","wR","wQ","wK","bP","bB","bN","bR","bQ","bK"]},27064:(e,t,n)=>{n.d(t,{R:()=>u});var i=n(24307),r=n(99523),a=n(99542),o=n(85278),l=n(89099),c=n(14232);let s=(0,a.eU)([]),d=(0,a.eU)(!1),u=e=>{let[t,n]=(0,c.useState)(null),[a,u]=(0,o.fp)(s),[h,m]=(0,o.fp)(d),[v,g]=(0,c.useState)(void 0);(0,c.useEffect)(()=>{void 0!==e&&m(e)},[e,m]),(0,c.useEffect)(()=>{(async()=>{n(await (0,r.P2)("games",1,{upgrade(e){e.createObjectStore("games",{keyPath:"id",autoIncrement:!0})}}))})()},[]);let f=(0,c.useCallback)(async()=>{t&&h&&u(await t.getAll("games"))},[t,h,u]);(0,c.useEffect)(()=>{f()},[f]);let p=(0,c.useCallback)(async e=>{if(!t)throw Error("Database not initialized");let n=(0,i.mi)(e),r=await t.add("games",n);return f(),r},[t,f]),w=(0,c.useCallback)(async(e,n)=>{if(!t)throw Error("Database not initialized");let i=await t.get("games",e);if(!i)throw Error("Game not found");await t.put("games",{...i,eval:n}),f()},[t,f]),b=(0,c.useCallback)(async e=>{if(t)return t.get("games",e)},[t]),x=(0,c.useCallback)(async e=>{if(!t)throw Error("Database not initialized");await t.delete("games",e),f()},[t,f]),{gameId:k}=(0,l.useRouter)().query;return(0,c.useEffect)(()=>{"string"==typeof k?b(parseInt(k)).then(e=>{g(e)}):g(void 0)},[k,g,b]),{addGame:p,setGameEval:w,getGame:b,deleteGame:x,games:a,isReady:null!==t,gameFromUrl:v}}},32253:(e,t,n)=>{n.d(t,{K:()=>d});var i=n(47713),r=n(24026),a=n(14679),o=n(43699),l=n(39228),c=n(19271),s=n(14232);let d=e=>{let[t,n]=(0,s.useState)(null);return(0,s.useEffect)(()=>{e&&(e===c.Qz.Stockfish11||(0,i.TH)())&&u(e).then(e=>{n(t=>(null==t||t.shutdown(),e))})},[e]),t},u=e=>{switch(e){case c.Qz.Stockfish17:return l.f.create(!1);case c.Qz.Stockfish17Lite:return l.f.create(!0);case c.Qz.Stockfish16_1:return o.m.create(!1);case c.Qz.Stockfish16_1Lite:return o.m.create(!0);case c.Qz.Stockfish16:return a.K.create(!1);case c.Qz.Stockfish16NNUE:return a.K.create(!0);case c.Qz.Stockfish11:return r.T.create()}}},37242:(e,t,n)=>{n.d(t,{v:()=>a});var i=n(85278),r=n(14232);function a(e,t){let[n,a]=(0,r.useState)(""),[o,l]=(0,i.fp)(t);return(0,r.useEffect)(()=>{var t;a(e);let n=window.localStorage.getItem(e);if(!n)return;let i="undefined"===(t=n)?void 0:JSON.parse(t);i&&l(i)},[e,l]),(0,r.useEffect)(()=>{n===e&&window.localStorage.setItem(e,JSON.stringify(o))},[e,n,o]),[o,l]}},65897:(e,t,n)=>{n.d(t,{j:()=>f});var i=n(24307);let r=null,a=null,o=new Map,l={move:"/sounds/move.mp3",capture:"/sounds/capture.mp3",illegalMove:"/sounds/error.mp3"},c=async e=>{a&&clearTimeout(a),a=setTimeout(async()=>{r||(r=new AudioContext),"suspended"===r.state&&await r.resume();let t=o.get(l[e]);if(!t){let n=await fetch(l[e]),i=await r.decodeAudioData(await n.arrayBuffer());t=i,o.set(l[e],i)}let n=r.createBufferSource();n.buffer=t;let i=r.createGain();i.gain.value=.3,n.connect(i),i.connect(r.destination),n.start()},1)},s=()=>c("capture"),d=()=>c("illegalMove"),u=()=>c("move"),h=e=>e?e.captured?s():u():d();var m=n(22277),v=n(85278),g=n(14232);let f=e=>{let[t,n]=(0,v.fp)(e),r=(0,g.useCallback)(e=>{let t=new m.d$;t.loadPgn(e),n(t)},[n]),a=(0,g.useCallback)(e=>{let t=new m.d$(null==e?void 0:e.fen);(null==e?void 0:e.noHeaders)||(0,i.nt)(t,e),n(t)},[n]),o=(0,g.useCallback)(()=>{let e=new m.d$;if(0===t.history().length){var n,i;let r=t.pgn().split("]");if(["1-0","0-1","1/2-1/2","*"].includes(null!==(i=null===(n=r.at(-1))||void 0===n?void 0:n.trim())&&void 0!==i?i:""))return e.loadPgn(r.slice(0,-1).join("]")+"]"),e}return e.loadPgn(t.pgn()),e},[t]),l=(0,g.useCallback)(e=>{let t=e?(0,i.w0)(e):o();t.load(t.getHeaders().FEN||m.OS,{preserveHeaders:!0}),n(t)},[o,n]),c=(0,g.useCallback)(e=>{let t=o();try{let{comment:i,...r}=e,a=t.move(r);return i&&t.setComment(i),n(t),h(a),a}catch(e){return d(),null}},[o,n]),s=(0,g.useCallback)(e=>{let t=o(),i=null;for(let n of e)i=t.move(n);n(t),i&&h(i)},[o,n]);return{setPgn:r,reset:a,playMove:c,undoMove:(0,g.useCallback)(()=>{let e=o(),t=e.undo();t&&h(t),n(e)},[o,n]),goToMove:(0,g.useCallback)((e,t)=>{if(e<0)return;let i=new m.d$;i.loadPgn(t.pgn());let r=t.history().length;if(e>r)return;let a={};for(let t=r;t>e;t--)a=i.undo();n(i),h(a)},[n]),resetToStartingPosition:l,addMoves:s}}},69846:(e,t,n)=>{n.d(t,{l:()=>r});var i=n(14232);let r=()=>{var e,t,n;let[r,a]=(0,i.useState)({width:null!==(n=null===(t=document)||void 0===t?void 0:null===(e=t.querySelector(".MuiGrid2-root"))||void 0===e?void 0:e.clientWidth)&&void 0!==n?n:500,height:window?window.innerHeight-120:500});return(0,i.useEffect)(()=>{var e;let t=null===(e=document)||void 0===e?void 0:e.querySelector(".MuiGrid2-root");if(!t)return;let n=new ResizeObserver(()=>a(e=>({...e,width:t.clientWidth})));return n.observe(t),()=>{n.disconnect()}},[]),(0,i.useEffect)(()=>{let e=()=>{a(e=>({...e,height:window.innerHeight-100}))};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),r}},82831:(e,t,n)=>{n.d(t,{K:()=>l});var i=n(85278),r=n(27064),a=n(41615),o=n(3816);let l=e=>{var t,n,a,o;let l=(0,i.md)(e),{gameFromUrl:s}=(0,r.R)(),d=l.getHeaders(),u=d.White&&"?"!==d.White?d.White:void 0,h=d.Black&&"?"!==d.Black?d.Black:void 0,m=(null==s?void 0:null===(t=s.white)||void 0===t?void 0:t.name)||u||"White",v=(null==s?void 0:null===(n=s.black)||void 0===n?void 0:n.name)||h||"Black",g=(null==s?void 0:null===(a=s.white)||void 0===a?void 0:a.rating)||Number(d.WhiteElo)||void 0,f=(null==s?void 0:null===(o=s.black)||void 0===o?void 0:o.rating)||Number(d.BlackElo)||void 0,p=((null==s?void 0:s.site)||d.Site||"unknown").toLowerCase().includes("chess.com"),w=c(m,p&&!!m&&"White"!==m),b=c(v,p&&!!v&&"Black"!==v);return{white:{name:m,rating:g,avatarUrl:null!=w?w:void 0},black:{name:v,rating:f,avatarUrl:null!=b?b:void 0}}},c=(e,t)=>{let{data:n}=(0,a.I)({queryKey:["CCAvatar",e],enabled:t,queryFn:()=>(0,o.e)(e),staleTime:36e5,gcTime:864e5});return n}},97121:(e,t,n)=>{n.d(t,{s:()=>o});var i=n(37876),r=n(77328),a=n.n(r);let o=e=>{let{title:t}=e;return(0,i.jsxs)(a(),{children:[(0,i.jsx)("title",{children:t}),(0,i.jsx)("meta",{property:"og:title",content:t})]})}},99509:(e,t,n)=>{n.d(t,{U:()=>a,_:()=>r});var i=n(42200);let r=(0,i.tG)("pieceSet","maestro"),a=(0,i.tG)("boardHue",0)}}]);