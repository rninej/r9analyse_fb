(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{16760:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(28798)}])},28798:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>no});var i=t(37876),a=t(52547),o=t(30566),r=t(8207),s=t(31084),l=t(11494),d=t(71538),c=t(49516),h=t(46061),u=t(84147),m=t(47866),g=t(3034),p=t(85278),x=t(14232),v=t(69241),f=t(4697),j=t(68197),y=t(80027),A=t(47951),w=t(45879);function b(e){return(0,w.Ay)("MuiFab",e)}let I=(0,A.A)("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]);var k=t(68275),C=t(54773),z=t(82987),S=t(78457),E=t(52196);let W=e=>{let{color:n,variant:t,classes:i,size:a}=e,o={root:["root",t,"size".concat((0,y.A)(a)),"inherit"===n?"colorInherit":n]},r=(0,f.A)(o,b,i);return{...i,...r}},M=(0,C.Ay)(j.A,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>(0,k.A)(e)||"classes"===e,overridesResolver:(e,n)=>{let{ownerState:t}=e;return[n.root,n[t.variant],n["size".concat((0,y.A)(t.size))],"inherit"===t.color&&n.colorInherit,n[(0,y.A)(t.size)],n[t.color]]}})((0,z.A)(e=>{var n,t;let{theme:i}=e;return{...i.typography.button,minHeight:36,transition:i.transitions.create(["background-color","box-shadow","border-color"],{duration:i.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(i.vars||i).zIndex.fab,boxShadow:(i.vars||i).shadows[6],"&:active":{boxShadow:(i.vars||i).shadows[12]},color:i.vars?i.vars.palette.text.primary:null===(n=(t=i.palette).getContrastText)||void 0===n?void 0:n.call(t,i.palette.grey[300]),backgroundColor:(i.vars||i).palette.grey[300],"&:hover":{backgroundColor:(i.vars||i).palette.grey.A100,"@media (hover: none)":{backgroundColor:(i.vars||i).palette.grey[300]},textDecoration:"none"},["&.".concat(I.focusVisible)]:{boxShadow:(i.vars||i).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),(0,z.A)(e=>{let{theme:n}=e;return{variants:[...Object.entries(n.palette).filter((0,S.A)(["dark","contrastText"])).map(e=>{let[t]=e;return{props:{color:t},style:{color:(n.vars||n).palette[t].contrastText,backgroundColor:(n.vars||n).palette[t].main,"&:hover":{backgroundColor:(n.vars||n).palette[t].dark,"@media (hover: none)":{backgroundColor:(n.vars||n).palette[t].main}}}}})]}}),(0,z.A)(e=>{let{theme:n}=e;return{["&.".concat(I.disabled)]:{color:(n.vars||n).palette.action.disabled,boxShadow:(n.vars||n).shadows[0],backgroundColor:(n.vars||n).palette.action.disabledBackground}}})),P=x.forwardRef(function(e,n){let t=(0,E.b)({props:e,name:"MuiFab"}),{children:a,className:o,color:r="default",component:s="button",disabled:l=!1,disableFocusRipple:d=!1,focusVisibleClassName:c,size:h="large",variant:u="circular",...m}=t,g={...t,color:r,component:s,disabled:l,disableFocusRipple:d,size:h,variant:u},p=W(g);return(0,i.jsx)(M,{className:(0,v.A)(p.root,o),component:s,disabled:l,focusRipple:!d,focusVisibleClassName:(0,v.A)(p.focusVisible,c),ownerState:g,ref:n,...m,classes:p,children:a})});var R=t(18259),L=t(19271),X=t(77018),_=t(88713),F=t(90405),K=t(35779),G=t(83290),N=t(6003),B=t(78523),T=t(24705),$=t(35656),H=t(82260),Y=t(37242);function V(){let[e,n]=(0,Y.v)("show-arrow-best-move",a.XL),[t,o]=(0,Y.v)("show-icon-player-move",a.a2);return(0,i.jsxs)(s.A,{container:!0,justifyContent:"space-evenly",alignItems:"center",size:12,gap:3,children:[(0,i.jsx)($.A,{control:(0,i.jsx)(H.A,{checked:e,onChange:(e,t)=>n(t)}),label:"Show engine best move arrow",sx:{marginX:0}}),(0,i.jsx)($.A,{control:(0,i.jsx)(H.A,{checked:t,onChange:(e,n)=>o(n)}),label:"Show played move icon",sx:{marginX:0}})]})}var D=t(47713),O=t(43699),U=t(99509),Q=t(54587),q=t.n(Q),J=t(92094),Z=t(92634);function ee(e){let{open:n,onClose:t}=e,[r,d]=(0,Y.v)("engine-depth",a.B2),[c,h]=(0,Y.v)("engine-multi-pv",a.FR),[v,f]=(0,Y.v)("engine-name",a.Ju),[j,y]=(0,p.fp)(U.U),[A,w]=(0,p.fp)(U._),[b,I]=(0,p.fp)(a.pN),k="dark"===(0,o.A)().palette.mode;return(0,x.useEffect)(()=>{(0,D.N9)(v)||(O.m.isSupported()?f(L.Qz.Stockfish16_1Lite):f(L.Qz.Stockfish11))},[f,v]),(0,i.jsxs)(u.A,{open:n,onClose:t,maxWidth:"md",fullWidth:!0,children:[(0,i.jsx)(m.A,{variant:"h5",sx:{paddingBottom:1},children:"Settings"}),(0,i.jsx)(g.A,{sx:{paddingBottom:0},children:(0,i.jsxs)(s.A,{container:!0,justifyContent:"center",alignItems:"center",paddingTop:1,spacing:3,size:12,children:[(0,i.jsx)(s.A,{container:!0,justifyContent:"center",size:{xs:12,sm:7,md:8},children:(0,i.jsxs)(X.A,{variant:"body2",children:[J.H[J.T3].small," is the default engine if your device support its requirements. It offers the best balance between speed and strength."," ",J.H[J.RS].small," is the strongest engine available, note that it requires a one time download of"," ",J.H[J.RS].sizeMb,"MB and is much more compute intensive."]})}),(0,i.jsx)(s.A,{container:!0,justifyContent:"center",size:{xs:12,sm:5,md:4},children:(0,i.jsxs)(_.A,{variant:"outlined",children:[(0,i.jsx)(F.A,{id:"dialog-select-label",children:"Engine"}),(0,i.jsx)(K.A,{labelId:"dialog-select-label",id:"dialog-select",displayEmpty:!0,input:(0,i.jsx)(G.A,{label:"Engine"}),value:v,onChange:e=>f(e.target.value),sx:{width:280,maxWidth:"100%"},children:Object.values(L.Qz).map(e=>(0,i.jsx)(N.A,{value:e,disabled:!(0,D.N9)(e),children:J.H[e].full},e))})]})}),(0,i.jsx)(R.A,{label:"Maximum depth",value:r,setValue:d,min:10,max:30,marksFilter:2}),(0,i.jsx)(R.A,{label:"Number of lines",value:c,setValue:h,min:2,max:6,marksFilter:1,size:6}),(0,i.jsx)(V,{}),(0,i.jsx)(s.A,{container:!0,justifyContent:"center",size:{xs:12,sm:8,md:9},children:(0,i.jsx)(R.A,{label:"Board hue",value:j,setValue:y,min:0,max:360})}),(0,i.jsx)(s.A,{container:!0,justifyContent:"center",alignItems:"center",size:{xs:12,sm:4,md:3},children:(0,i.jsxs)(_.A,{variant:"outlined",children:[(0,i.jsx)(F.A,{id:"dialog-select-label",children:"Piece set"}),(0,i.jsx)(K.A,{labelId:"dialog-select-label",id:"dialog-select",displayEmpty:!0,input:(0,i.jsx)(G.A,{label:"Piece set"}),value:A,onChange:e=>w(e.target.value),sx:{width:200,maxWidth:"100%"},children:J.PE.map(e=>(0,i.jsx)(N.A,{value:e,children:(0,i.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,i.jsx)(q(),{loading:"lazy",src:"/piece/".concat(e,"/").concat(k?"w":"b","N.svg"),alt:"".concat(e," knight"),width:24,height:24}),e]})},e))})]})}),(0,i.jsx)(s.A,{container:!0,justifyContent:"center",alignItems:"center",size:{xs:12,md:11},children:(0,i.jsx)(R.A,{label:"Number of threads",value:b,setValue:I,min:1,max:12,marksFilter:1,infoContent:(0,i.jsxs)(i.Fragment,{children:["More threads means faster analysis, but only if your device can handle them, otherwise it may have the opposite effect. The estimated optimal value for your device is"," ",(0,Z.PN)(),". Due to privacy restrictions in some browsers, this value might be underestimated. Don't hesitate to try different values to find the best one for your device."]})})})]})}),(0,i.jsx)(B.A,{sx:{m:1},children:(0,i.jsx)(T.A,{variant:"contained",onClick:t,children:"Close"})})]})}var en=t(98594);function et(){let[e,n]=(0,x.useState)(!1);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P,{title:"Engine settings",color:"secondary",size:"small",sx:{top:"auto",right:16,bottom:16,left:"auto",position:"fixed"},onClick:()=>n(!0),children:(0,i.jsx)(en.In,{icon:"mdi:settings",height:20})}),(0,i.jsx)(ee,{open:e,onClose:()=>n(!1)})]})}var ei=t(89243),ea=t(97121),eo=t(3816);class er{startWatching(e){this.intervalId=setInterval(async()=>{let n=await (0,eo.V)(this.username);if(n.length>0){let t=n[0];t.id!==this.lastGameId&&(this.lastGameId=t.id,e(t))}},1e4)}stopWatching(){this.intervalId&&clearInterval(this.intervalId)}constructor(e){this.lastGameId=null,this.intervalId=null,this.username=e}}var es=t(22277),el=t(89099),ed=t(69846),ec=t(19410),eh=t(82831);function eu(){let e=(0,ed.l)(),n=(0,p.md)(a.MA),t=(0,p.md)(a.XL),{white:o,black:r}=(0,eh.K)(a._X),s=(0,x.useMemo)(()=>{var n;let t=e.width,i=e.height;return(null===(n=window)||void 0===n?void 0:n.innerWidth)<1200?Math.min(t-15,i-150):Math.min(t-700,.92*i)},[e]);return(0,i.jsx)(ec.h,{id:"AnalysisBoard",boardSize:s,canPlay:!0,gameAtom:a.Sd,whitePlayer:o,blackPlayer:r,boardOrientation:n?L.Q1.White:L.Q1.Black,currentPositionAtom:a.eU,showBestMoveArrow:t,showPlayerMoveIconAtom:a.a2,showEvaluationBar:!0})}var em=t(27064);function eg(){let{gameFromUrl:e}=(0,em.R)(),n=(0,p.md)(a._X).getHeaders();if(!(void 0!==e||n.White&&"?"!==n.White))return null;let t=(null==e?void 0:e.termination)||n.Termination||"?",o=t.split(" ").length>2?t:(null==e?void 0:e.result)||n.Result||"?";return(0,i.jsxs)(s.A,{container:!0,justifyContent:"space-evenly",alignItems:"center",rowGap:1,columnGap:3,size:11,children:[(0,i.jsx)(s.A,{container:!0,justifyContent:"center",alignItems:"center",size:"grow",children:(0,i.jsxs)(X.A,{noWrap:!0,fontSize:"0.9rem",children:["Site : ",(null==e?void 0:e.site)||n.Site||"?"]})}),(0,i.jsx)(s.A,{container:!0,justifyContent:"center",alignItems:"center",size:"grow",children:(0,i.jsxs)(X.A,{noWrap:!0,fontSize:"0.9rem",children:["Date : ",(null==e?void 0:e.date)||n.Date||"?"]})}),(0,i.jsx)(s.A,{container:!0,justifyContent:"center",alignItems:"center",size:"grow",children:(0,i.jsxs)(X.A,{noWrap:!0,fontSize:"0.9rem",children:["Result : ",o]})})]})}var ep=t(88546),ex=t(65897),ev=t(3242);function ef(){let e=(0,el.useRouter)(),n=(0,p.md)(a._X),{setPgn:t}=(0,ex.j)(a._X),{resetToStartingPosition:o}=(0,ex.j)(a.Sd),{gameFromUrl:r}=(0,em.R)(),s=(0,p.Xr)(a.Mx),l=(0,p.Xr)(a.MA),d=(0,p.md)(a.xg),c=(0,x.useMemo)(()=>n.history().join(),[n]),h=(0,x.useCallback)((e,n,i)=>{let a=new es.d$;a.loadPgn(e),c!==a.history().join()&&(o(e),s(i),t(e),l(null==n||n))},[c,o,t,s,l]),{lichessGameId:u,orientation:m}=e.query;(0,x.useEffect)(()=>{let e=async e=>{let n=await (0,ev.e1)(e);"string"==typeof n&&h(n,"black"!==m)};if(r){let e="Chesskit.org"!==r.site||"You"!==r.black.name;h(r.pgn,e,r.eval)}else"string"==typeof u&&u&&e(u)},[r,u,m,h]),(0,x.useEffect)(()=>{let e=e=>{try{var n;if(!(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.pgn))return;let{pgn:t,orientation:i}=e.data;h(t,"black"!==i)}catch(e){console.error("Error processing message event:",e)}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[h]);let g=void 0!==r||!!n.getHeaders().White&&"?"!==n.getHeaders().White||n.history().length>0;return d?null:(0,i.jsx)(ep.A,{label:g?"Load another game":"Load game",size:"small",setGame:async n=>{await e.push("/"),h(n.pgn())}})}var ej=t(24307),ey=t(27449),eA=t(7045),ew=t(7957),eb=t(581);function eI(e){return(0,w.Ay)("MuiLoadingButton",e)}let ek=(0,A.A)("MuiLoadingButton",["root","label","loading","loadingIndicator","loadingIndicatorCenter","loadingIndicatorStart","loadingIndicatorEnd","endIconLoadingEnd","startIconLoadingStart"]),eC=e=>{let{loading:n,loadingPosition:t,classes:i}=e,a={root:["root",n&&"loading"],label:["label"],startIcon:[n&&`startIconLoading${(0,y.A)(t)}`],endIcon:[n&&`endIconLoading${(0,y.A)(t)}`],loadingIndicator:["loadingIndicator",n&&`loadingIndicator${(0,y.A)(t)}`]},o=(0,f.A)(a,eI,i);return{...i,...o}},ez=e=>"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e&&"classes"!==e,eS=(0,C.Ay)(T.A,{shouldForwardProp:e=>ez(e)||"classes"===e,name:"MuiLoadingButton",slot:"Root",overridesResolver:(e,n)=>[n.root,n.startIconLoadingStart&&{[`& .${ek.startIconLoadingStart}`]:n.startIconLoadingStart},n.endIconLoadingEnd&&{[`& .${ek.endIconLoadingEnd}`]:n.endIconLoadingEnd}]})((0,z.A)(({theme:e})=>({display:"inline-flex",[`& .${ek.startIconLoadingStart}, & .${ek.endIconLoadingEnd}`]:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0},variants:[{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${ek.loading}`]:{color:"transparent"}}},{props:({ownerState:e})=>"start"===e.loadingPosition&&e.fullWidth,style:{[`& .${ek.startIconLoadingStart}, & .${ek.endIconLoadingEnd}`]:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0,marginRight:-8}}},{props:({ownerState:e})=>"end"===e.loadingPosition&&e.fullWidth,style:{[`& .${ek.startIconLoadingStart}, & .${ek.endIconLoadingEnd}`]:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0,marginLeft:-8}}}]}))),eE=(0,C.Ay)("span",{name:"MuiLoadingButton",slot:"LoadingIndicator",overridesResolver:(e,n)=>{let{ownerState:t}=e;return[n.loadingIndicator,n[`loadingIndicator${(0,y.A)(t.loadingPosition)}`]]}})((0,z.A)(({theme:e})=>({position:"absolute",visibility:"visible",display:"flex",variants:[{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:({loadingPosition:e,ownerState:n})=>"start"===e&&"small"!==n.size,style:{left:14}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:({loadingPosition:e,ownerState:n})=>"end"===e&&"small"!==n.size,style:{right:14}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:({ownerState:e})=>"start"===e.loadingPosition&&e.fullWidth,style:{position:"relative",left:-10}},{props:({ownerState:e})=>"end"===e.loadingPosition&&e.fullWidth,style:{position:"relative",right:-10}}]}))),eW=(0,C.Ay)("span",{name:"MuiLoadingButton",slot:"Label",overridesResolver:(e,n)=>[n.label]})({display:"inherit",alignItems:"inherit",justifyContent:"inherit"}),eM=x.forwardRef(function(e,n){let t=x.useContext(eA.A),a=(0,eb.A)(t,e),o=(0,E.b)({props:a,name:"MuiLoadingButton"}),{children:r,disabled:s=!1,id:l,loading:d=!1,loadingIndicator:c,loadingPosition:h="center",variant:u="text",...m}=o,g=(0,ey.A)(l),p=c??(0,i.jsx)(ew.A,{"aria-labelledby":g,color:"inherit",size:16}),v={...o,disabled:s,loading:d,loadingIndicator:p,loadingPosition:h,variant:u},f=eC(v),j=d?(0,i.jsx)(eE,{className:f.loadingIndicator,ownerState:v,children:p}):null;return(0,i.jsxs)(eS,{disabled:s||d,id:g,ref:n,...m,variant:u,classes:f,ownerState:v,children:["end"===v.loadingPosition?(0,i.jsx)(eW,{className:f.label,children:r}):j,"end"===v.loadingPosition?j:(0,i.jsx)(eW,{className:f.label,children:r})]})});var eP=t(32253),eR=t(9320),eL=t(29791),eX=t(44371);let e_=e=>{let[n,t]=(0,p.fp)(a.eU),i=(0,p.md)(a.Mx),o=(0,p.md)(a._X),r=(0,p.md)(a.Sd),s=(0,p.md)(a.B2),l=(0,p.md)(a.FR),[d,c]=(0,p.fp)(a.Sp);return(0,x.useEffect)(()=>{var n;let a=r.history({verbose:!0}),h={lastMove:a.at(-1)},u=o.history();if(a.length<=u.length&&u.slice(0,a.length).join()===a.map(e=>e.san).join()&&(h.currentMoveIdx=a.length,i)){let e=a.length;h.eval={...i.positions[e],lines:i.positions[e].lines.slice(0,l)},h.lastEval=e>0?{...i.positions[e-1],lines:i.positions[e-1].lines.slice(0,l)}:void 0}if(!(null===(n=h.eval)||void 0===n?void 0:n.opening))for(let e of a.slice().reverse()){let n=e.after.split(" ")[0],t=eX.m.find(e=>e.fen===n);if(t){h.opening=t.name;break}}if(t(h),!h.eval&&(null==e?void 0:e.getIsReady())&&e.name&&!r.isCheckmate()&&!r.isStalemate()){let n=async(n,t)=>{var i,a,o;if(!e.getIsReady())throw Error("Engine not ready");let r=d[n];if(r&&r.engine===e.name&&(null!==(a=null===(i=r.lines)||void 0===i?void 0:i.length)&&void 0!==a?a:0)>=l&&(null!==(o=r.lines[0].depth)&&void 0!==o?o:0)>=s){let e={...r,lines:r.lines.slice(0,l)};return null==t||t(e),e}let h=await e.evaluatePositionWithUpdate({fen:n,depth:s,multiPv:l,setPartialEval:t});return c(t=>({...t,[n]:{...h,engine:e.name}})),h};(async()=>{let e=await n(r.fen(),e=>{t({...h,eval:e})});if(0===a.length)return;let i=(0,ej.kf)(r),o=i.fens.slice("w"===r.turn()?-3:-4),s=i.uciMoves.slice("w"===r.turn()?-2:-3),l=await n(o.slice(-2)[0]),d=o.map((n,t)=>t===o.length-2?l:t===o.length-1?e:{lines:[{pv:[],depth:0,multiPv:1,cp:1}]}),c=(0,eL.R)(d,s,o);t({...h,eval:c.slice(-1)[0],lastEval:c.slice(-2)[0]})})()}return()=>{(null==e?void 0:e.getIsReady())&&(null==e||e.stopAllCurrentJobs())}},[i,r,o,e,s,l]),n};function eF(){let e=(0,p.md)(a.Ju),n=(0,eP.K)(e);e_(n);let t=(0,p.md)(a.pN),[o,r]=(0,p.fp)(a.xg),s=(0,p.md)(a.B2),l=(0,p.md)(a.FR),{setGameEval:d,gameFromUrl:c}=(0,em.R)(),[h,u]=(0,p.fp)(a.Mx),m=(0,p.md)(a._X),g=(0,p.Xr)(a.Sp),{white:v,black:f}=(0,eh.K)(a._X),j=(null==n?void 0:n.getIsReady())&&m.history().length>0&&!o,y=(0,x.useCallback)(async()=>{let i=(0,ej.kf)(m);if(!(null==n?void 0:n.getIsReady())||0===i.fens.length||o)return;let a=await n.evaluateGame({...i,depth:s,multiPv:l,setEvaluationProgress:r,playersRatings:{white:null==v?void 0:v.rating,black:null==f?void 0:f.rating},workersNb:t});u(a),r(0),c&&d(c.id,a);let h=i.fens.reduce((n,t,i)=>(n[t]={...a.positions[i],engine:e},n),{});g(e=>({...e,...h})),(0,eR.$)("analyze_game",{engine:e,depth:s,multiPv:l,nbPositions:i.fens.length})},[n,e,t,m,s,l,o,r,u,c,d,g,v.rating,f.rating]);return((0,x.useEffect)(()=>{r(0)},[n,r]),(0,x.useEffect)(()=>{!h&&j&&y()},[h,j,y]),o)?null:(0,i.jsx)(eM,{variant:"contained",size:"small",startIcon:(0,i.jsx)(en.In,{icon:"streamline:magnifying-glass-solid",height:12}),onClick:y,disabled:!j,children:(0,i.jsx)(X.A,{fontSize:"0.9em",fontWeight:"500",lineHeight:"1.4em",children:h?"Analyze again":"Analyze"})})}var eK=t(75328),eG=t(6800);let eN=e=>0===e.value?null:(0,i.jsxs)(s.A,{container:!0,alignItems:"center",justifyContent:"center",wrap:"nowrap",width:"90%",columnGap:2,size:12,children:[(0,i.jsx)(X.A,{variant:"caption",align:"center",children:e.label}),(0,i.jsx)(s.A,{sx:{width:"100%"},children:(0,i.jsx)(eK.A,{variant:"determinate",...e,sx:e=>({borderRadius:"5px",height:"5px",["&.".concat(eG.A.colorPrimary)]:{backgroundColor:e.palette.grey["light"===e.palette.mode?200:700]},["& .".concat(eG.A.bar)]:{borderRadius:5,backgroundColor:J.sl}})})}),(0,i.jsx)(s.A,{children:(0,i.jsx)(X.A,{variant:"body2",color:"text.secondary",children:"".concat(Math.round(e.value),"%")})})]});function eB(){let e=(0,p.md)(a.xg);return(0,i.jsxs)(s.A,{container:!0,justifyContent:"center",alignItems:"center",rowGap:2,size:12,children:[(0,i.jsxs)(s.A,{container:!0,justifyContent:"center",alignItems:"center",columnGap:1,size:12,children:[(0,i.jsx)(en.In,{icon:"streamline:clipboard-check",height:24}),(0,i.jsx)(X.A,{variant:"h5",align:"center",children:"Game Analysis"})]}),(0,i.jsxs)(s.A,{container:!0,justifyContent:"center",alignItems:"center",rowGap:2,columnGap:12,size:12,children:[(0,i.jsx)(eg,{}),(0,i.jsx)(ef,{}),(0,i.jsx)(eF,{}),(0,i.jsx)(eN,{value:e,label:"Analyzing..."})]})]})}var eT=t(22430),e$=t(70946);function eH(){let e=(0,p.Xr)(a.MA);return(0,x.useEffect)(()=>{let n=n=>{"f"===n.key&&e(e=>!e)};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[e]),(0,i.jsx)(eT.A,{title:"Flip board",children:(0,i.jsx)(e$.A,{onClick:()=>e(e=>!e),sx:{paddingX:1.2,paddingY:.5},children:(0,i.jsx)(en.In,{icon:"eva:flip-fill"})})})}function eY(){let{playMove:e}=(0,ex.j)(a.Sd),n=(0,p.md)(a._X),t=(0,p.md)(a.Sd),o=n.history(),r=t.history(),l=r.length<o.length&&o.slice(0,r.length).join()===r.join(),d=(0,x.useCallback)(()=>{var t;if(!l)return;let i=r.length,a=n.history({verbose:!0})[i],o=null===(t=n.getComments().find(e=>e.fen===a.after))||void 0===t?void 0:t.comment;a&&e({from:a.from,to:a.to,promotion:a.promotion,comment:o})},[l,r,n,e]);return(0,x.useEffect)(()=>{let e=e=>{"ArrowRight"===e.key&&d()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[d]),(0,i.jsx)(eT.A,{title:"Go to next move",children:(0,i.jsx)(s.A,{children:(0,i.jsx)(e$.A,{onClick:()=>d(),disabled:!l,sx:{paddingX:1.2,paddingY:.5},children:(0,i.jsx)(en.In,{icon:"ri:arrow-right-s-line",height:30})})})})}function eV(){let{setPgn:e}=(0,ex.j)(a.Sd),n=(0,p.md)(a._X),t=(0,p.md)(a.Sd),o=n.history(),r=t.history()>=o;return(0,x.useEffect)(()=>{let t=t=>{"ArrowUp"!==t.key||r||e(n.pgn())};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[r,e,n]),(0,i.jsx)(eT.A,{title:"Go to final position",children:(0,i.jsx)(s.A,{children:(0,i.jsx)(e$.A,{onClick:()=>{r||e(n.pgn())},disabled:r,sx:{paddingX:1.2,paddingY:.5},children:(0,i.jsx)(en.In,{icon:"ri:skip-forward-line"})})})})}function eD(){let e=(0,p.md)(a._X),n=(0,p.md)(a.Sd),t=(0,p.md)(a.Mx),{addGame:o,setGameEval:r,gameFromUrl:l}=(0,em.R)(),d=(0,el.useRouter)(),c=!l&&(n.history().length||e.history().length),h=async()=>{if(!c)return;let i=(0,ej.FA)(e,n),a=await o(i);t&&await r(a,t),d.replace({query:{gameId:a},pathname:d.pathname},void 0,{shallow:!0,scroll:!1})};return(0,i.jsx)(i.Fragment,{children:l?(0,i.jsx)(eT.A,{title:"Game saved in database",children:(0,i.jsx)(s.A,{children:(0,i.jsx)(e$.A,{disabled:!0,sx:{paddingX:1.2,paddingY:.5},children:(0,i.jsx)(en.In,{icon:"ri:folder-check-line"})})})}):(0,i.jsx)(eT.A,{title:"Save game",children:(0,i.jsx)(s.A,{children:(0,i.jsx)(e$.A,{onClick:h,disabled:!c,sx:{paddingX:1.2,paddingY:.5},children:(0,i.jsx)(en.In,{icon:"ri:save-3-line"})})})})})}function eO(){let e=(0,p.md)(a.Sd),{resetToStartingPosition:n,undoMove:t}=(0,ex.j)(a.Sd),o=e.history(),r=(0,p.md)(a._X);return(0,x.useEffect)(()=>{let e=e=>{0!==o.length&&("ArrowLeft"===e.key?t():"ArrowDown"===e.key&&n())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t,o,n,e]),(0,i.jsxs)(s.A,{container:!0,justifyContent:"center",alignItems:"center",size:12,children:[(0,i.jsx)(eH,{}),(0,i.jsx)(eT.A,{title:"Reset board",children:(0,i.jsx)(s.A,{children:(0,i.jsx)(e$.A,{onClick:()=>n(),disabled:0===o.length,sx:{paddingX:1.2,paddingY:.5},children:(0,i.jsx)(en.In,{icon:"ri:skip-back-line"})})})}),(0,i.jsx)(eT.A,{title:"Go to previous move",children:(0,i.jsx)(s.A,{children:(0,i.jsx)(e$.A,{onClick:()=>t(),disabled:0===o.length,sx:{paddingX:1.2,paddingY:.5},children:(0,i.jsx)(en.In,{icon:"ri:arrow-left-s-line",height:30})})})}),(0,i.jsx)(eY,{}),(0,i.jsx)(eV,{}),(0,i.jsx)(eT.A,{title:"Copy pgn",children:(0,i.jsx)(s.A,{children:(0,i.jsx)(e$.A,{disabled:0===r.history().length,onClick:()=>{var e,n;null===(n=navigator.clipboard)||void 0===n||null===(e=n.writeText)||void 0===e||e.call(n,r.pgn())},sx:{paddingX:1.2,paddingY:.5},children:(0,i.jsx)(en.In,{icon:"ri:clipboard-line"})})})}),(0,i.jsx)(eD,{})]})}var eU=t(9227),eQ=t(34428),eq=t(68327),eJ=t(79534),eZ=t.n(eJ);function e0(e){let{san:n,color:t,additionalText:a,typographyProps:r,boxProps:s}=e,d="dark"===(0,o.A)().palette.mode,{icon:c,text:h}=(0,x.useMemo)(()=>{let e=n.charAt(0);if(!["K","Q","R","B","N"].includes(e))return{text:n};let i=d?t:"w"===t?"b":"w";return{icon:e1[e][i],text:n.slice(1)}},[n,t,d]);return(0,i.jsxs)(l.A,{component:"span",...s,children:[c&&(0,i.jsx)(X.A,{component:"span",fontFamily:eZ().style.fontFamily,...r,children:c}),(0,i.jsxs)(X.A,{component:"span",noWrap:!0,...r,children:[h,a]})]})}let e1={K:{w:"♚",b:"♔"},Q:{w:"♛",b:"♕"},R:{w:"♜",b:"♖"},B:{w:"♝",b:"♗"},N:{w:"♞",b:"♘"}};function e2(){var e,n,t,o,r,s,l,d;let c=(0,p.md)(a.eU),h=(0,p.md)(a.Sd),u=null==c?void 0:null===(e=c.lastEval)||void 0===e?void 0:e.bestMove,m=(0,x.useMemo)(()=>{var e;if(!u)return;let n=null===(e=h.history({verbose:!0}).at(-1))||void 0===e?void 0:e.before;if(n)return(0,ej.AC)(n)(u)},[u,h]);if(0===h.history().length)return null;if(!m)return(0,i.jsx)(eU.A,{direction:"row",alignItems:"center",columnGap:5,marginTop:.8,children:(0,i.jsx)(eq.A,{variant:"rounded",animation:"wave",width:"12em",sx:{color:"transparent",maxWidth:"7vw"},children:(0,i.jsx)(X.A,{align:"center",fontSize:"0.9rem",children:"placeholder"})})});let g=null===(n=c.eval)||void 0===n?void 0:n.moveClassification,v=g!==L.eK.Best&&g!==L.eK.Opening&&g!==L.eK.Forced&&g!==L.eK.Splendid&&g!==L.eK.Perfect;return(0,i.jsxs)(eU.A,{direction:"row",alignItems:"center",justifyContent:"center",columnGap:4,marginTop:.5,flexWrap:"wrap",children:[g&&(0,i.jsxs)(eU.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,i.jsx)(q(),{src:"/icons/".concat(g,".png"),alt:"move-icon",width:16,height:16,style:{maxWidth:"3.5vw",maxHeight:"3.5vw"}}),(0,i.jsx)(e0,{typographyProps:{fontSize:"0.9rem"},san:null!==(s=null===(t=c.lastMove)||void 0===t?void 0:t.san)&&void 0!==s?s:"",color:null!==(l=null===(o=c.lastMove)||void 0===o?void 0:o.color)&&void 0!==l?l:"w",additionalText:" is "+e5[g]})]}),v&&(0,i.jsxs)(eU.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,i.jsx)(q(),{src:"/icons/best.png",alt:"move-icon",width:16,height:16,style:{maxWidth:"3.5vw",maxHeight:"3.5vw"}}),(0,i.jsx)(e0,{typographyProps:{fontSize:"0.9rem"},san:m,color:null!==(d=null===(r=c.lastMove)||void 0===r?void 0:r.color)&&void 0!==d?d:"w",additionalText:" was the best move"})]})]})}let e5={[L.eK.Opening]:"an opening move",[L.eK.Forced]:"forced",[L.eK.Splendid]:"splendid !!",[L.eK.Perfect]:"the only good move !",[L.eK.Best]:"the best move",[L.eK.Excellent]:"excellent",[L.eK.Okay]:"an okay move",[L.eK.Inaccuracy]:"an inaccuracy",[L.eK.Mistake]:"a mistake",[L.eK.Blunder]:"a blunder"};function e4(){var e;let n=(0,p.md)(a.eU);if(!(null==n?void 0:n.lastMove))return null;let t=(null==n?void 0:null===(e=n.eval)||void 0===e?void 0:e.opening)||n.opening;return t?(0,i.jsx)(s.A,{children:(0,i.jsx)(X.A,{align:"center",fontSize:"0.9rem",maxWidth:"20rem",children:t})}):(0,i.jsx)(s.A,{justifyItems:"center",alignContent:"center",children:(0,i.jsx)(eq.A,{variant:"rounded",animation:"wave",width:"12em",sx:{color:"transparent",maxWidth:"7vw",maxHeight:"3.5vw"},children:(0,i.jsx)(X.A,{align:"center",fontSize:"0.9rem",children:"placeholder"})})})}var e9=t(63009),e3=t(12572);function e6(e){let{line:n}=e,t=(0,p.md)(a.Sd),{addMoves:o}=(0,ex.j)(a.Sd),r=(0,ej.l3)(n),s=void 0!==n.cp&&n.cp<0||void 0!==n.mate&&n.mate<0,l=n.depth<6,d=(0,ej.AC)(t.fen()),c=t.turn(),h=e=>e%2==0?c:"w"===c?"b":"w";return(0,i.jsxs)(e3.Ay,{disablePadding:!0,children:[(0,i.jsx)(X.A,{marginRight:1.5,marginY:.3,paddingY:.2,noWrap:!0,overflow:"visible",width:"3.5em",minWidth:"3.5em",textAlign:"center",fontSize:"0.8rem",sx:{backgroundColor:s?"black":"white",color:s?"white":"black"},borderRadius:"5px",border:"1px solid #424242",fontWeight:"500",children:l?(0,i.jsx)(eq.A,{variant:"rounded",animation:"wave",sx:{color:"transparent"},children:"placeholder"}):r}),(0,i.jsx)(X.A,{noWrap:!0,fontSize:"0.9rem",children:l?(0,i.jsx)(eq.A,{variant:"rounded",animation:"wave",width:"20em"}):n.pv.map((e,t)=>{let a=d(e),r=h(t);return(0,i.jsx)(e0,{san:a,color:r,additionalText:t<n.pv.length-1?",":"",boxProps:{onClick:()=>{o(n.pv.slice(0,t+1))},sx:{cursor:"pointer",ml:.5*!!t,transition:"opacity 0.2s ease-in-out","&:hover":{opacity:.5}}}},t)})})]})}function e7(e){var n,t;let o=(0,p.md)(a.Sd),r=(0,p.md)(a.FR),l=(0,p.md)(a.eU),d=Array.from({length:r}).map((e,n)=>({pv:["".concat(n)],depth:0,multiPv:n+1})),c=(null==l?void 0:null===(t=l.eval)||void 0===t?void 0:null===(n=t.lines)||void 0===n?void 0:n.length)?l.eval.lines:d;return o.isCheckmate()?null:(0,i.jsx)(s.A,{container:!0,justifyContent:"center",alignItems:"center",...e,children:(0,i.jsx)(e9.A,{sx:{width:"95%",padding:0},children:c.map(e=>(0,i.jsx)(e6,{line:e},e.multiPv))})})}function e8(e){let n=(0,p.md)(a.Mx),t=(0,p.md)(a._X),o=(0,p.md)(a.Sd),r=o.history(),l=t.history(),d=r.length>0&&(o.isCheckmate()||o.isDraw()||r.join()===l.join());return(0,i.jsxs)(s.A,{container:!0,size:12,justifyContent:{xs:"center",lg:n?"start":"center"},alignItems:"center",flexWrap:{lg:n?"nowrap":void 0},gap:2,marginY:{lg:n?1:void 0},paddingX:{xs:0,lg:"calc(4% - 2rem)"},...e,sx:e.hidden?{display:"none"}:e.sx,children:[(0,i.jsxs)(eU.A,{justifyContent:"center",alignItems:"center",rowGap:1,minWidth:n?"min(25rem, 95vw)":void 0,children:[n&&(0,i.jsx)(eQ.A,{title:"Accuracy",whiteValue:"".concat(n.accuracy.white.toFixed(1)," %"),blackValue:"".concat(n.accuracy.black.toFixed(1)," %")}),(null==n?void 0:n.estimatedElo)&&(0,i.jsx)(eQ.A,{title:"Game Rating",whiteValue:Math.round(n.estimatedElo.white),blackValue:Math.round(n.estimatedElo.black)}),(0,i.jsx)(e2,{}),(0,i.jsx)(e4,{}),d&&(0,i.jsx)(X.A,{align:"center",fontSize:"0.9rem",noWrap:!0,children:"Game is over"})]}),(0,i.jsx)(e7,{size:{lg:n?void 0:12}})]})}var ne=t(45175);function nn(){let{white:e,black:n}=(0,eh.K)(a._X),t=(0,p.md)(a.Mx);return(null==t?void 0:t.positions.length)?(0,i.jsxs)(s.A,{container:!0,justifyContent:"center",alignItems:"center",rowGap:.7,sx:{scrollbarWidth:"thin",overflowY:"auto"},height:"100%",maxHeight:"22rem",size:12,children:[(0,i.jsxs)(s.A,{container:!0,alignItems:"center",justifyContent:"space-evenly",wrap:"nowrap",size:12,children:[(0,i.jsx)(X.A,{width:"12rem",align:"center",noWrap:!0,fontSize:"0.9rem",children:e.name}),(0,i.jsx)(X.A,{width:"10rem"}),(0,i.jsx)(X.A,{width:"12rem",align:"center",noWrap:!0,fontSize:"0.9rem",children:n.name})]}),nt.map(e=>(0,i.jsx)(ne.A,{classification:e},e))]}):null}let nt=[L.eK.Splendid,L.eK.Perfect,L.eK.Best,L.eK.Excellent,L.eK.Okay,L.eK.Opening,L.eK.Inaccuracy,L.eK.Mistake,L.eK.Blunder];function ni(e){return(0,i.jsx)(s.A,{container:!0,justifyContent:"center",alignItems:"center",size:12,flexGrow:1,...e,sx:{...e.hidden?{display:"none"}:{overflow:"hidden",...e.sx},flexDirection:"column"},children:(0,i.jsx)(nn,{})})}var na=t(55663);function no(){let e=(0,o.A)(),n=(0,r.A)(e.breakpoints.up("lg")),{chessComUsername:t}=(0,el.useRouter)().query,v=(0,p.md)(a.XZ)||t,f=(0,p.md)(a.Mx),j=(0,p.md)(a._X),y=(0,p.md)(a.Sd),A=(0,p.Xr)(a._X),w=j.history().length>0||y.history().length>0,[b,I]=(0,x.useState)(null),[k,C]=(0,x.useState)(null),[z,S]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{if(k){let e=new es.d$;e.loadPgn(k.pgn),A(e),S(!0)}},[k,A]),(0,x.useEffect)(()=>{if(f&&z){try{"serviceWorker"in navigator&&navigator.serviceWorker.controller?navigator.serviceWorker.getRegistration().then(e=>{e&&e.showNotification("Game Analysis Complete",{body:"Your new game has been automatically analyzed."})}):new Notification("Game Analysis Complete",{body:"Your new game has been automatically analyzed."})}catch(e){console.error("Failed to create notification:",e)}S(!1)}},[f,z]),(0,x.useEffect)(()=>{if("string"==typeof v&&v){let e=()=>{let e=new er(v);e.startWatching(e=>{C(e)}),I(e)};"granted"!==Notification.permission?Notification.requestPermission().then(n=>{"granted"===n&&e()}):e()}return()=>{null==b||b.stopWatching()}},[v]),(0,i.jsxs)(s.A,{container:!0,gap:4,justifyContent:"space-evenly",alignItems:"start",children:[(0,i.jsx)(ea.s,{title:"MrAnalyse Game Analysis"}),(0,i.jsx)(eu,{}),(0,i.jsxs)(s.A,{container:!0,justifyContent:"start",alignItems:"center",borderRadius:2,border:1,borderColor:"secondary.main",sx:{backgroundColor:"secondary.main",borderColor:"primary.main",borderWidth:2,boxShadow:"0 2px 10px rgba(0, 0, 0, 0.5)"},padding:2,style:{maxWidth:"1200px"},rowGap:2,height:{xs:"auto",lg:"calc(95vh - 60px)"},display:"flex",flexDirection:"column",flexWrap:"nowrap",size:{xs:12,lg:"grow"},children:[n?(0,i.jsxs)(l.A,{width:"100%",children:[(0,i.jsx)(eB,{},"analysis-panel-header"),(0,i.jsx)(d.A,{sx:{marginX:"5%",marginTop:2.5}})]}):(0,i.jsx)(eO,{},"review-panel-toolbar"),!n&&!f&&(0,i.jsx)(d.A,{sx:{marginX:"5%"}}),!n&&!f&&(0,i.jsx)(eB,{},"analysis-panel-header"),n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ei.A,{id:"tabContent2"}),(0,i.jsx)(e8,{id:"tabContent0"}),(0,i.jsx)(ni,{id:"tabContent1"})]}):(0,i.jsxs)(l.A,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",children:[(0,i.jsx)(e8,{id:"tabContent0"}),f&&(0,i.jsx)(d.A,{sx:{width:"90%",my:2}}),f&&(0,i.jsx)(ei.A,{id:"tabContent2"}),w&&(0,i.jsx)(d.A,{sx:{width:"90%",my:2}}),w&&(0,i.jsx)(ni,{id:"tabContent1"})]}),n&&(0,i.jsxs)(l.A,{width:"100%",children:[(0,i.jsx)(d.A,{sx:{marginX:"5%",marginBottom:1.5}}),(0,i.jsx)(eO,{},"review-panel-toolbar")]}),!n&&f&&(0,i.jsxs)(l.A,{width:"100%",children:[(0,i.jsx)(d.A,{sx:{marginX:"5%",marginBottom:2.5}}),(0,i.jsx)(eB,{},"analysis-panel-header")]})]}),(0,i.jsx)(et,{}),(0,i.jsx)(c.A,{open:!!k,autoHideDuration:6e3,onClose:()=>C(null),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,i.jsxs)(h.A,{onClose:()=>C(null),severity:"success",sx:{width:"100%"},children:["New game found: ",null==k?void 0:k.white.name," vs ",null==k?void 0:k.black.name]})}),(0,i.jsxs)(u.A,{open:!v,fullWidth:!0,maxWidth:"sm",children:[(0,i.jsx)(m.A,{children:"Welcome to MrAnalyse"}),(0,i.jsxs)(g.A,{children:[(0,i.jsx)("p",{children:"To get started, please enter your Chess.com username below. This will allow MrAnalyse to automatically fetch and analyze your games as you play them."}),(0,i.jsx)(na.A,{})]})]})]})}},79534:e=>{e.exports={style:{fontFamily:"'chessFont', 'chessFont Fallback'"},className:"__className_bd706f"}}},e=>{var n=n=>e(e.s=n);e.O(0,[774,969,233,696,358,986,302,585,546,636,593,792],()=>n(16760)),_N_E=e.O()}]);